import{g as v,d as m,m as y,u as N,r as f,e as h,a,F as z,j as s,I}from"./index.ed54fe83.js";import{u as F}from"./index.esm.4b8c3923.js";import{I as P,l as S,M as U}from"./MessageBox.19e1a4a3.js";import{u as E,T as w}from"./Input.1cb7b307.js";const T=v`
  mutation Authorize($username: String!, $password: String!) {
    authorizeUser(username: $username, password: $password) {
      success
      status
      token
    }
  }
`,_=()=>{const{t:r}=m();return a("div",{className:"flex justify-center flex-col mb-14 mt-20",children:[s("img",{className:"h-24",src:"/photoview-logo.svg",alt:"photoview logo"}),s("h1",{className:"text-3xl text-center mt-4",children:r("login_page.welcome","Welcome to Photoview")})]})},q=()=>{var c,p;const{t:r}=m(),{register:o,handleSubmit:e,formState:{errors:t}}=F(),[i,{loading:n,data:u}]=E(T,{onCompleted:l=>{const{success:b,token:g}=l.authorizeUser;b&&g&&S(g)}}),x=l=>{i({variables:{username:l.username,password:l.password}})},d=u&&!u.authorizeUser.success?u.authorizeUser.status:null;return a("form",{className:"mx-auto max-w-[500px] px-4",onSubmit:e(x),children:[s(w,{sizeVariant:"big",wrapperClassName:"my-6",className:"w-full",label:r("login_page.field.username","Username"),...o("username",{required:!0}),error:((c=t.username)==null?void 0:c.type)=="required"?"Please enter a username":void 0}),s(w,{sizeVariant:"big",wrapperClassName:"my-6",className:"w-full",type:"password",label:r("login_page.field.password","Password"),...o("password",{required:!0}),error:((p=t.password)==null?void 0:p.type)=="required"?"Please enter a password":void 0}),s("input",{type:"submit",disabled:n,value:r("login_page.field.submit","Sign in"),className:"rounded-md px-8 py-2 mt-2 focus:outline-none cursor-pointer bg-gradient-to-bl from-[#FF8246] to-[#D6264D] text-white font-semibold focus:ring-2 focus:ring-red-200 disabled:cursor-default disabled:opacity-80"}),s(U,{message:d,show:!!d,type:"negative"})]})},k=()=>{var t,i;const{t:r}=m(),o=y(),{data:e}=N(P,{variables:{}});return f.exports.useEffect(()=>{h()&&o("/")},[]),f.exports.useEffect(()=>{var n;(n=e==null?void 0:e.siteInfo)!=null&&n.initialSetup&&o("/initialSetup")},[(t=e==null?void 0:e.siteInfo)==null?void 0:t.initialSetup]),h()||((i=e==null?void 0:e.siteInfo)==null?void 0:i.initialSetup)?null:a(z,{children:[s(I,{children:a("title",{children:[r("title.login","Login")," - Photoview"]})}),a("div",{children:[s(_,{}),s(q,{})]})]})};export{k as default};
